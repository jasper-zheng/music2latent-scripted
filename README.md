# Music2Latent-Scripted

Exporting [Music2Latent](https://github.com/SonyCSLParis/music2latent.git) to TorchScript for streamable continuous inference, to be used with [nn~](https://github.com/acids-ircam/nn_tilde.git) in MaxMSP/PureDara.  



https://github.com/user-attachments/assets/912aae55-618b-4e69-900c-c8c491dbef24




## How to export  


<!-- 1. Please download the pre-trained Music2Latent model [here](https://huggingface.co/SonyCSLParis/music2latent)   -->


will add instruction here later.... see the first 5 cells in [export.ipynb](export.ipynb)



## Latent space tricks  

### Latent space walk



https://github.com/user-attachments/assets/1db70fbe-af01-4f19-ba40-6e1e082c2e8d



### Latent space walk with latent terrain (2D Granular Synthesis)  

https://github.com/user-attachments/assets/81164bda-b2da-4844-8c55-f057656dad78

[Full Video](https://www.youtube.com/watch?v=98geiJ_P-uQ)


## To-do  
 - `export.py`   
 - Adapt to [2d cached-conv](https://github.com/jasper-zheng/cached_conv2d)  
 - smaller music2latent for light-weight inference  

